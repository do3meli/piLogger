#!/bin/bash

this_dir=$(cd `dirname $0`; pwd)
. $this_dir/functions

#--------------------------------
# usage()
#--------------------------------
usage(){
cat<<EOT

Usage:

  `basename $0` [-rrd] alias|/path/to/device

EOT
}

#================================
# MAIN
#================================
[ -z "$1" ] && { usage ; exit 1 ; }

case $1 in
  -h|--help)
    usage
    exit 0
    ;;
  -rrd)
    [ -n "$debug" ] && logIt "device: $2"
    time getLastRRDUpdate $2
    exit 0
    ;;
   *)
    curDevice=$1
    [ -n "$debug" ] && logIt "device: $1"
    [ -d $curDevice ] && { getTemperatureByDevicePath $curDevice ; exit 0 ; }
    [ -d /mnt/1wire/$curDevice ] && { getTemperatureByDevicePath /mnt/1wire/$curDevice ; exit 0 ; }
    [ ! -d $curDevice ] && getTemperatureByDeviceAlias $curDevice
    ;;
esac
